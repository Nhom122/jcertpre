<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8" />
  <title>Thi: <span th:text="${exam.title}">TiÃªu Ä‘á»</span></title>
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
  <script>
    // HÃ m Ä‘áº¿m ngÆ°á»£c, tá»± submit form khi háº¿t giá»
    let durationSeconds = /*[[${exam.durationMinutes}]]*/ * 60;
    let timerInterval;

    function startTimer() {
      const timerEl = document.getElementById('timer');
      timerInterval = setInterval(() => {
        if (durationSeconds <= 0) {
          clearInterval(timerInterval);
          alert('Háº¿t giá»! BÃ i thi sáº½ Ä‘Æ°á»£c tá»± Ä‘á»™ng ná»™p.');
          document.getElementById('examForm').submit();
          return;
        }
        let minutes = Math.floor(durationSeconds / 60);
        let seconds = durationSeconds % 60;
        timerEl.textContent = `Thá»i gian cÃ²n láº¡i: ${minutes} phÃºt ${seconds} giÃ¢y`;
        durationSeconds--;
      }, 1000);
    }

    window.onload = startTimer;
  </script>
</head>
<body>
<div class="container mt-4">
  <h2>ğŸ“ LÃ m bÃ i thi: <span th:text="${exam.title}"></span></h2>
  <p th:text="${exam.description}"></p>

  <div id="timer" class="alert alert-info font-weight-bold"></div>

  <form th:action="@{/exam/submit}" th:object="${examResult}" method="post" id="examForm">
    <input type="hidden" name="examId" th:value="${exam.id}" />

    <div th:each="question, iterStat : ${exam.questions}">
      <div class="form-group">
        <label th:text="'CÃ¢u ' + ${iterStat.index + 1} + ': ' + question"></label>
        <input type="text" class="form-control" th:name="'answers[' + ${iterStat.index} + ']'" required />
      </div>
    </div>

    <button type="submit" class="btn btn-success">Ná»™p bÃ i</button>
  </form>
</div>
</body>
</html>
