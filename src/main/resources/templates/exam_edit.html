<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8" />
    <title>Ch·ªânh s·ª≠a ƒë·ªÅ thi</title>
    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <style>
        .checkbox-list {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #ccc;
            padding: 10px;
        }
    </style>
</head>
<body>
<div class="container mt-4">
    <h2>‚úèÔ∏è Ch·ªânh s·ª≠a ƒë·ªÅ thi</h2>
    <form th:action="@{/instructor/exam/edit/{id}(id=${exam.id})}" method="post">
    <input type="hidden" name="id" th:value="${exam.id}" />

        <div class="form-group">
            <label>Ti√™u ƒë·ªÅ ƒë·ªÅ thi</label>
            <input type="text" name="title" class="form-control" th:value="${exam.title}" required />
        </div>

        <div class="form-group">
            <label>M√¥ t·∫£</label>
            <textarea name="description" class="form-control" th:text="${exam.description}"></textarea>
        </div>

        <div class="form-group">
            <label>Th·ªùi gian l√†m b√†i (ph√∫t)</label>
            <input type="number" name="durationMinutes" class="form-control" th:value="${exam.durationMinutes}" min="1" required />
        </div>

        <div class="form-group">
            <label>Ch·ªçn c√¢u h·ªèi (√≠t nh·∫•t 1)</label>
            <div class="checkbox-list">
                <div th:each="q : ${quizItems}">
                    <input type="checkbox"
                           th:id="'quizItem' + ${q.id}"
                           th:name="quizItemIds"
                           th:value="${q.id}"
                           th:checked="${#lists.contains(exam.quizItems, q)}" />
                    <label th:for="'quizItem' + ${q.id}">
                        <b th:text="${q.text}"></b>
                        (<span th:text="${'ƒê√°p √°n ƒë√∫ng: ' + q.correctAnswer + '. ' + q.getCorrectOp(q.correctAnswer)}">ƒê√°p √°n ƒë√∫ng: A</span>)
                    </label>
                </div>
            </div>
        </div>

        <button type="submit" class="btn btn-success">üíæ L∆∞u thay ƒë·ªïi</button>
        <a href="/jcertpre/instructor/exam/list" class="btn btn-secondary">Quay l·∫°i danh s√°ch</a>
    </form>
</div>

<script>
    document.addEventListener("DOMContentLoaded", function () {
        const form = document.querySelector("form");
        form.addEventListener("submit", function (e) {
            const checked = form.querySelectorAll("input[name='quizItemIds']:checked");
            if (checked.length === 0) {
                alert("Vui l√≤ng ch·ªçn √≠t nh·∫•t 1 c√¢u h·ªèi!");
                e.preventDefault();
            }
        });
    });
</script>

</body>
</html>
